---
import { Image } from "astro:assets";
import '../styles/nav.css'
---
<header id="header" class='fade-in navbar border-2 border-white border-opacity-10 fixed z-20 w-full bg-[#141E05]'>
  <div class="mt-0 xl:flex xl:items-center xl:justify-between container m-auto">
    <div class='flex items-center justify-between pt-2 pb-1 xl:w-auto z-20 xl:mr-0 xl:ml-0 relative'>
      <a href="/" class='logo w-36 hover:scale-105 transition-all duration-500 pb-2' aria-label="Link to Home Page">
        <img src="../images/logo1.png" alt="Harrington Electrical & Data Solutions Logo">
      </a>
      <button class='menu-button border-2 xl:hidden border-white border-opacity-40 py-[.3rem] px-[1rem] rounded-md text-sm text-white' aria-label="Menu button">Menu</button>
    </div>
    <div class='md:w-1/2 lg:w-5/12 bg-[#141E05] xl:bg-inherit w-full top-0 right-0 xl:w-full xl:px-5 xl:px:0 xl:pl-20 xl:pr-0 xl:static xl:top-auto xl:right-auto'>
      <nav class='hidden text-white w-full pt-8 xl:flex xl:h-min h-screen xl:pt-0 xl:mt-0 xl:justify-between xl:items-center'>
        <ul class='font-body border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 flex flex-col xl:flex-row xl:items-center'>
          <div class='nav-links border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 text-white xl:flex'>
            <li class="menu-item">
              <a href='/' class="py-4 border-b xl:border-none border-[#FFFFFF] border-opacity-20 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center" aria-label="Home page link">
                <h3 class="hover-lines hover:scale-105 duration-500">Home</h3>
                <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src="/images/arrow-right-solid.svg" alt="Toggle" />
              </a>
            </li>
            <li class="menu-item">
              <a href='/#about-us' class="internal-link border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 py-4 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center" aria-label="Link to about section">
                <h3 class="hover-lines hover:scale-105 duration-500">About Us</h3>
                <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src="/images/arrow-right-solid.svg" alt="Toggle" />
              </a>
            </li>
            <li class="menu-item">
              <a href='/residential' class="py-4 border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center" aria-label="Link to Residential Page">
                <h3 class="hover-lines hover:scale-105 duration-500">Residential</h3>
                <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src="/images/arrow-right-solid.svg" alt="Toggle" />
              </a>
            </li>
            <li class="menu-item">
              <a href='/commercial' class="py-4 border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center" aria-label="Link to Commercial page">
                <h3 class="hover-lines hover:scale-105 duration-500">Commercial</h3>
                <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src="/images/arrow-right-solid.svg" alt="Toggle" />
              </a>
            </li>
            <li class="menu-item">
              <a href='/#contact' class="internal-link py-4 border-b border-t xl:border-none border-[#FFFFFF] border-opacity-20 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center" aria-label="Link to Contact section">
                <h3 class="hover-lines hover:scale-105 duration-500">Contact</h3>
                <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src="/images/arrow-right-solid.svg" alt="Toggle" />
              </a>
            </li>
            <!-- <li class="menu-item">
              <a href='#' class="submenu-toggle py-4 border-t xl:border-none border-[#FFFFFF] border-opacity-20 font-light w-full flex justify-between xl:justify-normal xl:mr-14 text-base items-center">
                <h3 class="hover-lines">Contact Us</h3>
                <div>
                  <img class='w-3 xl:hidden xl:ml-2 xl:pt-1' src='/images/plus-solid.svg' alt="Toggle" />
                  <img class='w-3 hidden xl:block xl:ml-2 xl:pt-1 fill-white' src='/images/chevron-down-solid.svg' alt="Toggle" />
                </div>
              </a>
              <ul class='sub-menu hidden flex-col mb-3 gap-1 xl:mb-0 xl:fixed xl:top-[60px] xl:left-0 xl:w-screen xl:h-1/3 xl:bg-[#FFFFFF] border-opacity-20 xl:p-[12%] xl:text-2xl xl:justify-center'>
                <li>
                  <a href="#" class="block py-2 hover:bg-gray-200 text-white font-medium">Slovenia</a>
                </li>
                <li>
                  <a href="#" class="block py-2 hover:bg-gray-200 text-white font-medium">Italy</a>
                </li>
              </ul>
            </li> -->
          </div>
        </ul>
        <ul class='hidden xl:flex flex-col xl:flex-row xl:items-center'>
          <h3 class="font-deco text-sm font-light text-[#77B523] mr-6">Available 24/7</h3><img class='w-3 xl:hidden' src="/images/arrow-right-solid.svg"></img>
          <a class="hover:bg-[#77B523] hover:text-white hover:scale-[1.02] transition-all py-5 border-b sm:border-none border-[#FFFFFF] border-opacity-20 flex justify-between xl:border-white xl:border-2 xl:border-opacity-40 xl:border-solid xl:py-2 xl:px-4 xl:my: xl:rounded-md auto text-white hover:wiggle" href="tel:+61425 685 486"><img class="pr-2 phone" src="/images/phone.svg" alt="phone icon" aria-label="Link to call business"><h3 class="text-sm font-body text-light">0425 685 486</h3><img class='w-3 xl:hidden fill-white' src="/images/up-right-from-square-solid.svg"></img></a>
        </ul>
        <div class="text-[#77B523] text-sm font-deco mt-20 xl:hidden">
          <p class="mb-6 w-[80%]"> Oakleigh South VIC 3167</p>
          <div class="mb-6">
            <a href="tel:+61425 685 486" class="block" aria-label="Link to call business">P: +61425 685 486</a>
            <a href="mailto:info@harringtonelecdata.com" aria-label="Link to email business">E:Â info@harringtonelecdata.com</a>
          </div>
          <a href="https://www.facebook.com/p/Harrington-Electrical-Data-solutions-PTY-LTD-100041373374286/?paipv=0&eav=AfYXZ_muGPErW9aTq6IUgBf5FC4rERAMOfrAINqpWaEO1Edh0lQM3RAtJPYWP3JVY5Q&_rdr" target="_blank" aria-label="Link to business Facebook Page"><img src="/images/facebook.svg" alt="Facebook Icon"  class="hover:scale-110 transition-all duration-300 ease-out"></a>
        </div>
      </div>
      </nav>
    </div>
  </div>
</header>

<script>
// Navbar Toggle
const navBtn = document.querySelector('.menu-button');
const navBar = document.querySelector('nav');
const logoImg = document.querySelector('.logo img');
let menuOpen = false;

navBtn?.addEventListener('click', () => {
  menuOpen = !menuOpen; // Toggle the state
  navBar?.classList.toggle('hidden', !menuOpen);
  navBtn.textContent = menuOpen ? 'Close' : 'Menu'; // Toggle the button text
  
  if (!menuOpen) {
    resetSubmenus();
  }
});

// SubMenu Toggle for both Mobile and Desktop
const submenuToggles = document.querySelectorAll('.submenu-toggle');

submenuToggles.forEach((toggle) => {
  toggle.addEventListener('click', (e) => {
    e.preventDefault();
    const subMenu = toggle.closest('li').querySelector('.sub-menu');
    const isOpen = !subMenu.classList.contains('hidden');
    
    submenuToggles.forEach((btn) => {
      const btnIcon = btn.querySelector('img');
      btnIcon.src = btn.classList.contains('submenu-toggle') ? '/images/plus-solid.svg' : '/images/chevron-down-solid.svg';
    });
    document.querySelectorAll('.sub-menu').forEach((menu) => menu.classList.add('hidden'));
    
    if (!isOpen) {
      const btnIcon = toggle.querySelector('img');
      btnIcon.src = toggle.classList.contains('submenu-toggle') ? '/images/minus-solid.svg' : '/images/chevron-up-solid.svg';
      subMenu.classList.remove('hidden');
    }
  });
});

// Function to reset all submenus
function resetSubmenus() {
  submenuToggles.forEach((btn) => {
    const btnIcon = btn.querySelector('img');
    btnIcon.src = btn.classList.contains('submenu-toggle') ? '/images/plus-solid.svg' : '/images/chevron-down-solid.svg';
  });
  document.querySelectorAll('.sub-menu').forEach((menu) => menu.classList.add('hidden'));
}

// Close submenus when mouse leaves header
const header = document.querySelector('header');
header.addEventListener('mouseleave', () => {
  resetSubmenus();
});

// Hide submenus on scroll for larger screens
let lastScrollTop = 0;
window.addEventListener('scroll', () => {
  if (window.innerWidth >= 1280) {
    const st = window.pageYOffset || document.documentElement.scrollTop;
    if (st > lastScrollTop) {
      resetSubmenus();
    }
    lastScrollTop = st <= 0 ? 0 : st; // For Mobile or negative scrolling
  }
});

// Close mobile nav when clicking any internal link with the class .internal-link
const internalLinks = document.querySelectorAll('.internal-link');
internalLinks.forEach(link => {
  link.addEventListener('click', () => {
    if (menuOpen) {
      navBar?.classList.add('hidden');
      navBtn.textContent = 'Menu';
      menuOpen = false;
    }
  });
});




// //  FADE IN 
// const faders = document.querySelectorAll(".fade-in");
// const fadeUp = document.querySelectorAll(".fade-in-up");
// const fadeInLeft = document.querySelectorAll(".fade-in-left")
// const fadeInRight = document.querySelectorAll(".fade-in-right")
// const clipIn = document.querySelectorAll(".clip-in");

// const appearOnScrollOptions = {
//     threshold: 0,
//     rootMargin: "0px 0px 0px 0px"
// }

// const appearOnScroll = new IntersectionObserver
// (function(
//     entries, 
//     appearOnScroll
//     ) {
//     entries.forEach(entry => {
//         if(!entry.isIntersecting) {
//             return;
//         } else {
//             entry.target.classList.add('appear');
//             appearOnScroll.unobserve(entry.target);
//         }
//     });
// },
// appearOnScrollOptions);

// faders.forEach(fader => {
//     appearOnScroll.observe(fader);
// },
// fadeUp.forEach(fader => {
//     appearOnScroll.observe(fader)
// }),
// fadeInLeft.forEach(fader => {
//     appearOnScroll.observe(fader)
// }),
// fadeInRight.forEach(fader => {
//     appearOnScroll.observe(fader)
// }),
// clipIn.forEach(fader => {
//     appearOnScroll.observe(fader)
// })

// );
// NAVBAR


const navbar = document.querySelector('.navbar');
let lastScrollY = window.scrollY;

window.addEventListener("scroll", () => {
  if (lastScrollY < window.scrollY) {
    navbar.classList.add('nav-hidden');
  } else {
    navbar.classList.remove('nav-hidden');
  }
  if (window.scrollY <= 0) {
    navbar.classList.remove('nav-hidden');
  }
  lastScrollY = window.scrollY;
});